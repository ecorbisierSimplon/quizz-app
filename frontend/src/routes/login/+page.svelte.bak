<script lang="ts">
	export let data: { message: string };
	import type { ActionData, PageData } from '$lib/packages/types';
	import { email, emailError, password, passwordError, handleSubmit } from './+page';
	let dataLogin: PageData;
	let form: ActionData;
</script>

<h1>{data.message}</h1>

{#if form?.success}
	<!-- this message is ephemeral; it exists because the page was rendered in
       response to a form submission. it will vanish if the user reloads -->
	<p>Successfully logged in! Welcome back, {dataLogin.user.firstname}</p>
{:else}
	<form on:submit|preventDefault={handleSubmit}>
		<label>
			Email:
			<input type="email" bind:value={$email} />
			<span class="error">{$emailError}</span>
		</label>

		<label>
			Mot de passe:
			<input type="password" bind:value={$password} />
			<span class="error">{$passwordError}</span>
		</label>
		<button type="submit">Log in</button>
		<button formaction="?/register">Register</button>
	</form>
{/if}
